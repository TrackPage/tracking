(function(f){var b=window.AmazonUIPageJS||window.P,m=b._namespace||b.attributeErrors,a=m?m("InTransitActionsBuzzAssets",""):b;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,b,m){"use strict";f.register("in-transit-csm-metrics-utils",function(){var a,e;try{a=navigator.userAgent}catch(c){a=""}a&&(a=a.toLowerCase(),(a=a.match(/(chrome|firefox|safari|trident|ddge|opr|crios|fxios)/gi))&&0<a.length&&(-1<a.indexOf("safari")&&1<a.length?-1<a.indexOf("chrome")||-1<a.indexOf("crios")?
e="chrome":-1<a.indexOf("fxios")&&(e="firefox"):e=a[0]));var d=[],k=function(c){b.ue&&b.uex&&uex("ld",c,{wb:1});c=d.indexOf(c);-1<c&&d.splice(c,1)};b.addEventListener("beforeunload",function(c){for(;0<d.length;)k(d[0])});return{setScope:function(c){b.ue&&b.uet&&b.uet("tc",c);return c},setPreAjax:function(c){b.ue&&b.ues&&b.ues("t0",c,new Date)},setPostAjax:function(c){b.ue&&b.uet&&b.uet("be",c)},sendAjaxMetrics:function(c){b.ue&&b.uex&&b.uex("ld",c)},recordReftag:function(c,b){c.ajax({type:"POST",
url:"/gp/mobile/tag?"+b,success:function(c){console.log("record ref tag ajax call success: ",c)},error:function(c){console.log("ref tag ajax call error: ",c)}})},logFatal:function(c){if(b.ueLogError){var a=c.feature||"pt2-fatal-generic";b.ueLogError(c.error||{message:c.message||a},{logLevel:"FATAL",attribution:a})}},logError:function(c){if(b.ueLogError){var a=c.feature||"pt2-error-generic";b.ueLogError(c.error||{message:c.message||a},{logLevel:"ERROR",attribution:a})}},logWarn:function(c){if(b.ueLogError){var a=
c.feature||"pt2-warn-generic";b.ueLogError(c.error||{message:c.message||a},{logLevel:"WARN",attribution:a})}},incrementCount:function(c,a){b.ue&&b.ue.count&&(b.ue.count(c,(b.ue.count(c)||0)+1),a&&a.browser&&e&&b.ue.count(c+"-"+e,(b.ue.count(c+"-"+e)||0)+1))},startWidgetTimer:function(c){b.ue&&b.uet&&0>d.indexOf(c)&&(uet("bb",c,{wb:1}),d.push(c))},stopWidgetTimer:k}});"use strict";f.when("A").register("in-transit-url-utils",function(a){function b(a){return a.split("\x26").reduce(function(a,b){b=b.split("\x3d").map(function(a){return decodeURIComponent(a.replace(/\+/g,
" "))});a[b[0]]=b[1];return a},{})}var d=a.$;return{getQueryParameterFromUrl:function(a,c){a=-1<a.indexOf("?")?a.substr(a.indexOf("?")):"";-1<a.indexOf("#")&&(a=a.substring(0,a.indexOf("#")));a=b(a);return a[c]?a[c]:!1},addQueryParameterToUrl:function(a,b){var e=!1;-1<a.indexOf("#")&&(e=a.substring(a.indexOf("#")),a=a.substr(0,a.indexOf("#")));b=d.param(b);a=-1<a.indexOf("?")?a+("\x26"+b):a+("?"+b);return e?a+e:a}}});"use strict";f.when("A","in-transit-csm-metrics-utils","ready").register("in-transit-sign-in-again-or-do",
function(a,e){var d=-1!==b.location.host.indexOf("hp-shoppingportal")?"/portal/cstrac/progress-tracker/actions/is-authenticated":"/progress-tracker/package/actions/is-authenticated",k;return function(c,e,f,h,n){a.post(d,{params:{csrfToken:h.csrfToken},success:function(a){a.success&&a.value?n&&n():a.success?(a=c.$currentTarget,h.width=620>b.innerWidth?.75*b.innerWidth:600,h.name=f,h.dataStrategy="preload",k||(k=e.create(a,h)),k.update({header:h.header||""}).show()):console.log("service failed")},error:function(a){}})}});
"use strict";f.when("A","in-transit-csm-metrics-utils","a-tooltip","ready").register("in-transit-tooltip",function(a,b,d){function k(a){b.incrementCount(a+"-total");h&&(b.incrementCount(a+"-unique"),h=!1)}function c(a){f("body").addClass("in-transit-tooltip-style-override "+q.deviceType);f(".in-transit-tooltip-trigger."+a).attr("title","")}var f=a.$,q=a.state("page-state")||{},h=!0,n=function(b){a.declarative("a-tooltip","mouseenter",function(a){c(b);k(b)});a.declarative("a-tooltip","click",function(a){a.$event.preventDefault()})},
t=function(b){a.declarative("a-tooltip","click",function(a){c(b);a=f(".in-transit-tooltip-trigger."+b);a=d.get(a);a.isVisible()?a.hide():k(b)})};return function(a){"desktop"!==q.deviceType&&q.deviceType?t(a):n(a)}});"use strict";f.when("A","a-modal","a-button","jQuery","in-transit-url-utils","in-transit-csm-metrics-utils","in-transit-tooltip","ready").register("rescheduleCalendarDelivery",function(a,e,d,f,c,l,q){function h(){a.state.parse();p=a.state("page-state")||{};w=m();r=x+w;y=1==p.stringDebug;
v=g("#reschedule-calendar-page-container").hasClass("r2w");g(".in-transit-tooltip-trigger.reschedule-tooltip-trigger").length&&q("reschedule-tooltip-trigger");n();u()}function n(){var a=g(".reschedule-day.enabled"),c=g(".delivery-window"),d=g(".day-choice-button",".reschedule-day.enabled"),e=g(".window-choice-button",".delivery-window.enabled"),f=g(".reschedule-go-back"),k=g(".reschedule-month-label"),h=g(".calendar-inner-month-name");d.click(function(b){b=g(this).parent();if(!b.hasClass("selected")){a.removeClass("selected").attr("aria-checked",
"false");b.addClass("selected").attr("aria-checked","true");var d=b.data("day-number"),d=g("#delivery-window-for_"+d),e=b.data("month-title");k.text()!==e&&k.text(e);h.show().filter(function(a){return this.getAttribute("data-for-month-title")===e}).hide();c.removeClass("selected").attr("aria-checked","false");v?d.addClass("visible").siblings().removeClass("visible"):d.find(".delivery-window").addClass("selected").attr("aria-checked","true");u()}});e.click(function(a){a=g(this).parent();a.hasClass("selected")||
(c.removeClass("selected").attr("aria-checked","false"),a.addClass("selected").attr("aria-checked","true"),u())});f.click(function(){b.history&&"function"===typeof b.history.back&&b.history.back()})}function t(){var a=g(".delivery-window.selected"),b={day:null,window:null,tokenId:null};if(1!==g(".reschedule-day.selected").length||1!==a.length)return b;b.day=a.first().text();b.window=a.first().text();b.tokenId=a.first().data("token");return b}function u(){var a=d("#reschedule-submit-button"),b=t();
b.tokenId&&null!==b.tokenId?a.enable():a.disable()}function m(){return"?"+g.param({orderId:p.orderId,shipmentId:p.shipmentId,packageIndex:p.packageIndex})+"\x26amzlMessageId\x3d"}var g=a.$,p=a.state("page-state")||{},x=-1!==b.location.host.indexOf("hp-shoppingportal")?"/portal/cstrac/progress-tracker":"/progress-tracker/package",z=x+"/actions/in-transit/reschedule",A={isModalContent:"1"},w=m(),r=x+w,y=1==p.stringDebug,v=g("#reschedule-calendar-page-container").hasClass("r2w");a.declarative("intransit-reschedule-open-modal",
"click",function(d){d.$event.preventDefault();var f=d.$currentTarget;f.find("a").data("ref");d=a.extend({},d.data);d.width=620>b.innerWidth?.75*b.innerWidth:600;d.name="rescheduleCalendarModal";d.dataStrategy="ajax";"#"===f.find("a").attr("href")?d.url=f.find("a").attr("data-modalurl"):d.url=f.find("a").attr("href");d.url=c.addQueryParameterToUrl(d.url,A);e.create(f,d).show()});u();h();a.on("a:popover:ajaxContentLoaded:rescheduleCalendarModal",h);a.declarative("submit-reschedule","click",function(c){c.$event.preventDefault();
c=d("#reschedule-submit-button");if(!1!==c.isEnabled()){c.disable();var e=t().tokenId;c=v?"R2W":"R2D";"undefined"===typeof e||null===e||"undefined"===e?(e=v?"request-reschedule-ajax-call-window-toggle-token-not-set":"request-reschedule-ajax-call-token-never-attempted-to-set",l.logError({feature:e,message:"The reschedule token was not set before submitting ("+c+")"}),l.incrementCount(e),b.location=r+"8"):a.post(z,{params:{rescheduleToken:e,stringDebug:y,csrfToken:b.csrfToken},dataType:"json",success:function(a){var c=
a.requestRescheduleDisplayResponse;if(a.success)l.incrementCount("request-reschedule-ajax-call-success"),b.location=r+"7";else{l.incrementCount("request-reschedule-ajax-call-failure");var c=(c=c.failureReason)||0,d="";c&&(d=", failureReason: "+c);l.logError({feature:"request-reschedule-ajax-call-failure-log",message:"Failed to request reschedule due to responseCode: "+a.responseCode+d});b.location=r+"8"}},error:function(a){l.incrementCount("request-reschedule-ajax-call-error");l.logError({feature:"request-reschedule-ajax-call-error-log",
message:("Error making a request to reschedule with",a)});b.location=r+"8"}})}})});"use strict";f.when("A","in-transit-url-utils","rescheduleDelivery","ready").execute("in-transit-loaded",function(a,e){var d=["PackageProgressTracker"];"desktop"===(a.state("page-state")||{}).deviceType&&(e=e.getQueryParameterFromUrl(b.location.search||b.location.href,"showModal"))&&-1<d.indexOf(b.uept.pageType||"")&&(d=e.replace(/[^0-9a-z\-\_]/gi,""),a=a.$("[data-action\x3d"+d+"]"),1===a.length&&a.click())});"use strict";
f.when("A","mash","page-load").execute(function(a,e){var d=document.getElementById("redirectToPickupPointCTA");d&&(d.onclick=function(){try{return e.navstack.begin().modalOpen(d.href).end(),!1}catch(a){console.log(a)}},b.addEventListener("popstate",function(){if(!b.location.href.includes("location-selector"))try{e.navstack.begin().modalClose().end()}catch(a){console.log(a)}}))})});